<p-table
    #dt
    [columns]="columnas"
    [value]="data"
    [loading]="loading"
    responsiveLayout="scroll"
    styleClass="p-datatable-sm"
    [paginator]="showPaginator"
    [rows]="10"
    [tableStyle]="tableStyle"
    currentPageReportTemplate="{first} - {last} de {totalRecords} registros"
    [rowsPerPageOptions]="[10, 25, 50]"
    sortMode="multiple"
    class="hoverTable"
>
    @if (showCaption) {
        <ng-template pTemplate="caption">
            <div
                class="flex justify-content-between flex-column sm:flex-row flex-wrap"
            >
                <p-iconField iconPosition="left">
                    <p-inputIcon styleClass="pi pi-search" />
                    <input
                        pInputText
                        type="text"
                        (input)="dt.filterGlobal($event.target, 'contains')"
                        placeholder="Buscar palabra clave"
                    />
                </p-iconField>
                <p-multiSelect
                    [options]="columnas"
                    [(ngModel)]="selectedColumns"
                    optionLabel="header"
                    selectedItemsLabel="{0} Columnas seleccionadas"
                    placeholder="Seleccione Columnas"
                />
            </div>
        </ng-template>
    }
    <ng-template pTemplate="header" let-columns>
        <tr class="text-uppercase">
            @for (col of columns; track col.field) {
                <th [pSortableColumn]="col.field" [style.width]="col.width">
                    @if (col.type !== 'actions' && col.type !== 'item') {
                        <div [style.text-align]="col.text_header" class="">
                            <span> {{ col.header }}</span>
                            <p-sortIcon [field]="col.header"></p-sortIcon>
                        </div>
                    } @else {
                        <div [style.text-align]="col.text_header">
                            {{ col.header }}
                        </div>
                    }
                </th>
            }
        </tr>
    </ng-template>
    <ng-template
        pTemplate="body"
        let-rowData
        let-columns="columns"
        let-rowIndex="rowIndex"
    >
        <tr [pSelectableRow]="rowData">
            @for (col of columns; track $index; let i = $index) {
                <td>
                    @if (col.type === 'item') {
                        <div [style.text-align]="col.text">
                            <span>{{ rowIndex + 1 }}</span>
                        </div>
                    }

                    @if (col.type === 'text') {
                        <div [style.text-align]="col.text">
                            {{ rowData[col.field] }}
                        </div>
                    }
                    @if (col.type === 'actions') {
                        <div class="d-block text-center">
                            @for (item of actions; track item.accion) {
                                @if (item.type === 'item') {
                                    <button
                                        [rounded]="true"
                                        pButton
                                        pRipple
                                        [icon]="item.icon"
                                        [pTooltip]="item.labelTooltip"
                                        tooltipPosition="top"
                                        (click)="
                                            accionBtn(item.accion, rowData)
                                        "
                                        class="w-auto p-1"
                                        [ngClass]="item.class"
                                    ></button>
                                }
                            }
                        </div>
                    }
                </td>
            }
        </tr>
    </ng-template>
</p-table>
