<app-container-page
  title="Curriculas"
  [actions]="accionesCurricula"
  (accionBtnItem)="accionBtnItem($event)"
  ><p-toast />
  @if (iCurrId > 0) {
    <app-curricula-curso [iCurrId]="iCurrId"></app-curricula-curso>
  } @else {
    <app-table-primeng
      [columnas]="curriculasColumns"
      [actions]="accionesTablaCurricula"
      [data]="curriculas"
      (accionBtnItem)="accionBtnItem($event)"
    >
    </app-table-primeng>
  }
</app-container-page>

<p-dialog
  #dialog
  [(visible)]="visible"
  [modal]="true"
  [maximizable]="true"
  appendTo="body"
  (onHide)="(false)"
  [style]="{ width: '75rem' }"
>
  <ng-template pTemplate="header">
    <div class="inline-flex align-items-center justify-content-center gap-2">
      <span class="font-bold white-space-nowrap">
        {{ titulo }}
      </span>
    </div>
  </ng-template>
  <br />

  <form [formGroup]="frmCurriculas">
    <div class="col-12 grid">
      <div class="col-8">
        <span class="p-float-label">
          <input pInputText id="name" formControlName="cCurrDescripcion" />

          @if (
            frmCurriculas.get('cCurrDescripcion').dirty &&
            frmCurriculas.get('cCurrDescripcion').invalid &&
            frmCurriculas.get('cCurrDescripcion').touched
          ) {
            <small class="text-red-500"> Este campo es obligatorio. </small>
          }
          <label for="name">Nombre</label>
        </span>
      </div>
      <div class="col-2">
        <label for="pesoActitudinal">Es la vigente</label>
      </div>
      <div class="col-2">
        <p-toggleButton
          styleClass="w-full"
          onLabel="Si"
          offLabel="No"
          formControlName="bCurrEsLaVigente"
        />
      </div>
    </div>
    <div class="col-12 grid">
      <div class="col-6">
        <span class="p-float-label">
          <p-dropdown
            id="modalidad"
            styleClass="w-full"
            [options]="modalidades"
            optionLabel="name"
            optionValue="code"
            appendTo="body"
            formControlName="iModalServId"
            placeholder="Seleccione una modalidad"
          />
          @if (
            frmCurriculas.get('iModalServId').dirty &&
            frmCurriculas.get('iModalServId').invalid &&
            frmCurriculas.get('iModalServId').touched
          ) {
            <small class="text-red-500"> Debe seleccionar una opción. </small>
          }
          <label for="modalidad">Modalidad del servicio</label>
        </span>
      </div>
      <div class="col-6">
        <span class="p-float-label">
          <input pInputText id="mencion" formControlName="cCurrMencion" />
          <label for="mencion">Mención</label>
        </span>
      </div>
    </div>
    <div class="col-12 grid">
      <div class="col-4">
        <span class="p-float-label">
          <p-inputNumber
            inputId="nroHoras"
            formControlName="iCurrNroHoras"
            mode="decimal"
            inputStyleClass="w-full"
            [minFractionDigits]="0"
            [maxFractionDigits]="2"
          />

          <label for="nroHoras">Nro Horas</label>
        </span>
      </div>
      <div class="col-4">
        <span class="p-float-label">
          <p-inputNumber
            inputId="notaMinima"
            formControlName="iCurrNotaMinima"
            mode="decimal"
            inputStyleClass="w-full"
            [minFractionDigits]="0"
            [maxFractionDigits]="2"
          />
          <label for="notaMinima">Nota minima</label>
        </span>
      </div>
      <div class="col-4">
        <span class="p-float-label">
          <p-inputNumber
            inputId="totalCreditos"
            formControlName="iCurrTotalCreditos"
            mode="decimal"
            inputStyleClass="w-full"
            [minFractionDigits]="0"
            [maxFractionDigits]="2"
          />
          <label for="totalCreditos">Total de créditos</label>
        </span>
      </div>
    </div>
    <div class="col-12 grid">
      <div class="col-12">
        <span class="p-float-label">
          <p-editor
            id="totalCreditos"
            formControlName="cCurrPerfilEgresado"
            [style]="{ height: '80px', width: '100%' }"
          />
        </span>
      </div>
    </div>

    <div class="col-12 grid">
      <div class="col-2">
        <span class="p-float-label">
          <p-inputNumber
            inputStyleClass="w-full"
            placeholder="Peso de procedimiento"
            inputId="pesoProcedimiento"
            mode="decimal"
            [minFractionDigits]="0"
            [maxFractionDigits]="2"
            formControlName="nCurrPesoProcedimiento"
          />
          <label for="pesoProcedimiento">P. Procedimiento</label>
        </span>
      </div>
      <div class="col-2">
        <span class="p-float-label">
          <p-inputNumber
            inputId="pesoConceptual"
            placeholder="Peso conceptual"
            mode="decimal"
            inputStyleClass="w-full"
            [minFractionDigits]="0"
            [maxFractionDigits]="2"
            formControlName="cCurrPesoConceptual"
          />
          <label for="pesoConceptual">P. Conceptual</label>
        </span>
      </div>
      <div class="col-2">
        <span class="p-float-label">
          <p-inputNumber
            inputId="pesoActitudinal"
            mode="decimal"
            inputStyleClass="w-full"
            [minFractionDigits]="0"
            placeholder="Peso actitudinal"
            [maxFractionDigits]="2"
            formControlName="cCurrPesoActitudinal"
          />
          <label for="pesoActitudinal">P. Actitudinal</label>
        </span>
      </div>

      <div class="col-3">
        <span class="p-float-label">
          <input pInputText type="url" id="enlaceResolucion" formControlName="cCurrRsl" />
          <label for="enlaceResolucion">URL de la resolución</label>
        </span>
      </div>
      <div class="col-3">
        <span class="p-float-label">
          <p-calendar
            formControlName="dtCurrRsl"
            [iconDisplay]="'input'"
            [showIcon]="true"
            placeholder="Ingrese una fecha"
          >
          </p-calendar>
          <!-- fechaResolucion -->
          <label for="fechaResolucion">Fecha de la resolución</label>
        </span>
      </div>
    </div>
  </form>
  <!-- <p-button
                    styleClass="w-full"
                    icon="pi pi-plus"
                    class="col-12 grid align-content-center justify-content-center gap-3 text-bold text-xl"
                    label="Cursos"
                >
                </p-button> -->
  <!-- @if (!dialogs.curriculas.expand.cursos) {
            <div class="col-1">
                <button
                    class="border-none text-s bg-blue-500 text-white font-bold px-1 border-round w-full h-full mb-2 cursor-pointer"
                    (click)="showCursos()"
                >
                    <div class="grid text-xl row-gap-5">
                        <i class="col-12 text-2xl pi pi-cog"></i>
                        <div class="col-12 grid m-0 row-gap-2">
                            <span
                                class="col-12"
                                *ngFor="let char of 'CURSOS'.split('')"
                                >{{ char }}</span
                            >
                        </div>
                    </div>
                </button>
            </div>
        } -->
  <!-- @if (dialogs.curriculas.expand.cursos) { -->
  <!-- <p-divider type="solid" layout="vertical" /> -->
  <!-- 
        <app-container-page title="Cursos" [actions]="cursos.container.actions"
            (accionBtnItem)="cursos.container.accionBtnItem($event)">
            <app-table-primeng class="w-full" [columnas]="cursos.table.columns" [data]="cursos.table.data"
                [actions]="cursos.table.actions.core" (accionBtnItem)="cursos.table.accionBtnItem($event)" />
        </app-container-page> -->
  <!-- } -->

  <ng-template pTemplate="footer">
    <div class="grid">
      <div class="col-12 justify-content-between">
        <p-button
          pButton
          type="button"
          label="Cancel"
          icon="pi pi-times-circle"
          severity="danger"
          class="p-button-rounded p-button-text"
          (onClick)="visible = false"
        />
        <p-button
          *ngIf="bEditar"
          pButton
          type="button"
          icon="pi pi-save"
          label="Editar"
          class="p-button-rounded p-button-text"
          (click)="updCurriculas()"
          severity="warning"
          [disabled]="frmCurriculas.invalid"
        />
        <p-button
          *ngIf="!bEditar"
          pButton
          type="button"
          icon="pi pi-save"
          label="Guardar"
          class="p-button-rounded p-button-text"
          (click)="saveCurriculas()"
          severity="primary"
          [disabled]="frmCurriculas.invalid"
        />
      </div>
    </div>
  </ng-template>
</p-dialog>
