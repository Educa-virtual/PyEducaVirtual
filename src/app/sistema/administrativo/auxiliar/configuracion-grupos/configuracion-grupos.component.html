<div class="grid">
    <div class="col-12">
        <p-inputGroup>
            <p-inputGroupAddon> Buscar: </p-inputGroupAddon>
            <input pInputText placeholder="Buscar Grupo" [(ngModel)]="buscar" />
        </p-inputGroup>
    </div>
    <!-- boton para crear nuevo grupo -->
    <div class="col-3" style="height: 350px">
        <p-card
            styleClass="nuevo-card h-full flex justify-content-center align-items-center shadow-1"
            (click)="visible = true; accion = true; ocultarAccion = 0"
        >
            <i class="pi pi-plus-circle text-bold text-5xl"></i>
        </p-card>
    </div>
    <div class="col-3" *ngFor="let grupo of filtrarGrupos">
        <p-card header="Grupo {{ grupo.cGrupoNombre }}" styleClass="shadow-1">
            <div class="p-1 text-center">
                <i class="pi pi-user text-4xl"></i>
            </div>
            <div class="p-1">
                <p-inputGroup>
                    <p-inputGroupAddon>Cantidad:</p-inputGroupAddon>
                    <input
                        type="text"
                        [value]="grupo.administrativos"
                        pInputText
                        placeholder="0"
                        readonly
                    />
                </p-inputGroup>
            </div>
            <div class="p-1">
                <p-inputGroup>
                    <p-inputGroupAddon>Ingreso:</p-inputGroupAddon>
                    <input
                        type="text"
                        [value]="grupo.tConfHorarioEntTur | date: 'HH:mm'"
                        pInputText
                        placeholder="00:00"
                        readonly
                    />
                </p-inputGroup>
            </div>
            <div class="p-1">
                <p-inputGroup>
                    <p-inputGroupAddon>Salida:</p-inputGroupAddon>
                    <input
                        type="text"
                        [value]="grupo.tConfHorarioSalTur | date: 'HH:mm'"
                        pInputText
                        placeholder="00:00"
                        readonly
                    />
                </p-inputGroup>
            </div>
            <ng-template pTemplate="footer">
                <div class="flex">
                    <div class="flex-1 gap-3 m-1">
                        <p-button
                            label="Editar"
                            class="w-full"
                            styleClass="w-full"
                            icon="pi pi-pencil"
                            (click)="
                                opcion = 0;
                                horarioModulo.editarGrupo(grupo);
                                ocultarAccion = 1;
                                visible = true
                            "
                        />
                    </div>
                    <div class="flex-1 gap-3 mt-1">
                        <p-button
                            label="Agregar"
                            severity="warning"
                            class="w-full"
                            styleClass="w-full"
                            icon="pi pi-user-plus"
                            (click)="
                                personalModulo.verPersonal(grupo);
                                opcion = 1;
                                visible = true;
                                ocultarAccion = 2
                            "
                        />
                    </div>
                </div>
            </ng-template>
        </p-card>
    </div>
</div>

<p-dialog
    header="Header"
    [(visible)]="visible"
    [modal]="true"
    [styleClass]="opcion === 0 ? 'w-3' : 'w-full'"
    [maximizable]="true"
>
    <ng-template pTemplate="header">
        <div
            class="inline-flex align-items-center justify-content-center gap-2 text-2xl"
        >
            <span class="font-bold white-space-nowrap">
                {{ accion ? 'Crear' : 'Editar' }} Grupos de Asistencia
            </span>
        </div>
    </ng-template>
    <br />
    <div class="grid">
        <div class="col-12">
            <app-horario
                #horarioModulo
                [datosGrupos]="datosGrupos"
                [hidden]="opcion !== 0"
            ></app-horario>
            <app-personal
                [hidden]="opcion !== 1"
                [personal]="personal"
            ></app-personal>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <p-button
            label="Cancelar"
            severity="secondary"
            (click)="visible = false"
        />
        <p-button
            *ngIf="ocultarAccion === 0"
            label="Guardar"
            [outlined]="true"
            severity="success"
            (click)="horarioModulo.guardarGrupo()"
        />
        <p-button
            *ngIf="ocultarAccion === 1"
            label="Editar Grupo"
            [outlined]="true"
            severity="warning"
            (click)="horarioModulo.actualizarGrupo()"
        />
        <p-button
            *ngIf="ocultarAccion === 2"
            label="Guardar Personal"
            [outlined]="true"
            severity="success"
            (click)="personalModulo.guardarPersonal()"
        />
    </ng-template>
</p-dialog>

<p-toast />
<p-confirmDialog />
