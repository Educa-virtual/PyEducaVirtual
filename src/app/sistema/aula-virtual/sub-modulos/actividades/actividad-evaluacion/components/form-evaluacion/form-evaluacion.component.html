<app-modal-primeng
    [title]="titulo"
    [showModal]="showModalEvaluacion"
    [width]="'90%'"
    (accionBtnItem)="accionBtn({ accion: 'close-modal', item: [] })"
>
    @switch (showMostrarVista) {
        @case ('FORM-EVALUACION') {
            <form
                [formGroup]="formEvaluacion"
                class="mt-4"
                *ngIf="formEvaluacion"
            >
                <div class="grid">
                    <div class="col-12">
                        <p-message
                            styleClass="w-full"
                            severity="info"
                            [text]="
                                'SEMANA ' +
                                semanaEvaluacion?.cContenidoSemNumero +
                                ': ' +
                                semanaEvaluacion?.cContenidoSemTitulo
                            "
                        ></p-message>
                    </div>
                    <div class="col-12">
                        <p-inputGroup>
                            <p-inputGroupAddon>Nombre</p-inputGroupAddon>
                            <input
                                type="text"
                                pInputText
                                placeholder="Ingrese el nombre de la evaluación"
                                formControlName="cEvaluacionTitulo"
                            />
                        </p-inputGroup>
                    </div>
                    <div class="col-12">
                        <label for="descripcion" class="mt-1"
                            >Descripción o Instrucciones
                            <span class="text-red-500 text-xs"
                                >(*) Obligatorio</span
                            ></label
                        >
                        <div class="mt-2">
                            <p-editor
                                styleClass="w-full"
                                formControlName="cEvaluacionDescripcion"
                                [style]="{ height: '150px' }"
                                placeholder="Ingrese la descripción o instrucciones"
                            />
                            @if (
                                formEvaluacion
                                    .get('cEvaluacionDescripcion')
                                    .hasError('required') &&
                                formEvaluacion.get('cEvaluacionDescripcion')
                                    ?.touched
                            ) {
                                <small class="text-red-500">
                                    Este campo es requerido.
                                </small>
                            }
                        </div>
                    </div>
                    <div class="col-12 md:col-4">
                        <p-inputGroup>
                            <p-inputGroupAddon>Tipo</p-inputGroupAddon>
                            <p-dropdown
                                styleClass="w-full"
                                placeholder="Seleccione Tipo"
                                optionValue="iTipoEvalId"
                                formControlName="iTipoEvalId"
                                [options]="tipoEvaluaciones"
                                optionLabel="cTipoEvalNombre"
                                [styleClass]="
                                    formEvaluacion.get('iTipoEvalId')
                                        ?.invalid &&
                                    formEvaluacion.get('iTipoEvalId')?.touched
                                        ? 'w-full ng-dirty ng-invalid p-invalid'
                                        : 'w-full'
                                "
                            />
                        </p-inputGroup>
                        <div class="ml-7">
                            @if (
                                formEvaluacion
                                    .get('iTipoEvalId')
                                    .hasError('required') &&
                                formEvaluacion.get('iTipoEvalId')?.touched
                            ) {
                                <small class="text-red-500">
                                    Este campo es requerido
                                </small>
                            }
                        </div>
                    </div>
                    <div class="col-12 md:col-4">
                        <p-inputGroup>
                            <p-inputGroupAddon
                                >Fecha - Hora Inicio
                            </p-inputGroupAddon>
                            <p-calendar
                                appendTo="body"
                                formControlName="dFechaEvaluacionInico"
                                [iconDisplay]="'input'"
                                styleClass="w-full"
                                [showIcon]="true"
                                [showTime]="true"
                                [hourFormat]="'24'"
                                inputId="dFechaEvaluacionInico"
                            />
                        </p-inputGroup>
                    </div>

                    <div class="col-12 md:col-4">
                        <p-inputGroup>
                            <p-inputGroupAddon
                                >Fecha - Hora Fin</p-inputGroupAddon
                            >
                            <p-calendar
                                appendTo="body"
                                formControlName="dFechaEvaluacionFin"
                                [iconDisplay]="'input'"
                                styleClass="w-full"
                                [showIcon]="true"
                                [showTime]="true"
                                [hourFormat]="'24'"
                                inputId="dFechaEvaluacionFin"
                            />
                        </p-inputGroup>
                    </div>
                    <div class="col-12 mt-1">
                        <app-types-files-upload-primeng
                            [nameFile]="'evaluacion'"
                            [nameOption]="'evaluacion'"
                            [typesFiles]="typesFiles"
                            (actionTypesFileUpload)="accionBtn($event)"
                            [filesUrl]="filesUrl"
                        ></app-types-files-upload-primeng>
                    </div>
                </div>
            </form>
        }
        @case ('LIST-PREGUNTAS') {
            <app-list-preguntas
                [data]="this.formEvaluacion.value"
                (accionBtnItem)="accionBtn($event)"
            ></app-list-preguntas>
        }
    }
    <div footer class="flex justify-content-end gap-2">
        <p-button
            label="Cancelar"
            severity="secondary"
            (onClick)="accionBtn({ accion: 'close-modal', item: [] })"
        />
        @switch (showMostrarVista) {
            @case ('FORM-EVALUACION') {
                <p-button
                    [label]="opcionEvaluacion"
                    (onClick)="
                        accionBtn({ accion: opcionEvaluacion, item: [] })
                    "
                />
            }
        }
    </div>
</app-modal-primeng>
<p-toast></p-toast>
