<form [formGroup]="formFamiliar">
    <br />

    <p-fieldset legend="Relación familiar con el estudiante">
        <div class="pt-2 grid p-fluid mt-3">
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Relación familiar * </p-inputGroupAddon>
                    <p-dropdown
                        [options]="tipos_familiares"
                        formControlName="iTipoFamiliarId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>
                        <p-inputSwitch formControlName="bFamiliarVivoConEl" />
                        <span>¿Vive en la misma dirección del estudiante?</span>
                    </p-inputGroupAddon>
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>

    <br />

    <p-fieldset legend="Identidad">
        <div class="pt-2 grid p-fluid mt-3">
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Tipo de Documento *</p-inputGroupAddon>
                    <p-dropdown
                        [options]="tipos_documentos"
                        formControlName="iTipoIdentId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-6 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>
                        <p-button
                            size="small"
                            label="Validar"
                            styleClass="p-button-primary"
                            (onClick)="validarPersona()"
                            severity="success"
                        />
                        Documento *
                    </p-inputGroupAddon>
                    <p-inputMask
                        formControlName="cPersDocumento"
                        [maxlength]="longitud_documento"
                        [mask]="formato_documento"
                        autoClear="false"
                        slotChar=""
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-6 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Sexo *</p-inputGroupAddon>
                    <p-dropdown
                        [options]="sexos"
                        formControlName="cPersSexo"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-6 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Estado Civil</p-inputGroupAddon>
                    <p-dropdown
                        [options]="estados_civiles"
                        formControlName="iTipoEstCivId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Nombres *</p-inputGroupAddon>
                    <input
                        pInputText
                        id="cPersNombre"
                        formControlName="cPersNombre"
                        aria-describedby="cPersNombre-help"
                        maxlength="50"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Primer Apellido *</p-inputGroupAddon>
                    <input
                        pInputText
                        id="cPersPaterno"
                        formControlName="cPersPaterno"
                        aria-describedby="cPersPaterno-help"
                        maxlength="50"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Segundo Apellido </p-inputGroupAddon>
                    <input
                        pInputText
                        id="cPersMaterno"
                        formControlName="cPersMaterno"
                        aria-describedby="cPersMaterno-help"
                        maxlength="50"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>

    <br />

    <p-fieldset legend="Nacimiento">
        <div class="grid p-fluid mt-3">
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Nacionalidad</p-inputGroupAddon>
                    <p-dropdown
                        [options]="nacionalidades"
                        formControlName="iNacionId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>
                        Fecha de nacimiento *</p-inputGroupAddon
                    >
                    <p-calendar
                        formControlName="dPersNacimiento"
                        [iconDisplay]="'input'"
                        [showIcon]="true"
                        inputId="dPersNacimiento"
                        [appendTo]="'body'"
                        [maxDate]="fecha_actual"
                        inputStyleClass="group-element"
                    />
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>

    <br />

    <p-fieldset legend="Dirección del familiar" *ngIf="ver_controles_direccion">
        <div class="grid p-fluid mt-3">
            <div class="col-12 lg:col-4 md:col-6">
                <app-dropdown-input
                    [dropdownControl]="
                        $any(formFamiliar.controls['iTipoViaId'])
                    "
                    addonLabel="Tipo de vía *"
                    [dropdownItems]="tipos_vias"
                    placeholder="Seleccione"
                    [filter]="true"
                    [showClear]="true"
                    inputType="text"
                    [inputControl]="$any(formFamiliar.controls['cTipoViaOtro'])"
                    inputPlaceholder="Especifique otro"
                    [inputMaxlength]="100"
                />
            </div>

            <div class="col-12 lg:col-8 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Nombre de la vía * </p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionNombreVia"
                        maxlength="150"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Nro. de Puerta </p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionNroPuerta"
                        maxlength="10"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Bloque</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionBlock"
                        maxlength="3"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Interior</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionInterior"
                        maxlength="3"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Piso</p-inputGroupAddon>
                    <p-inputNumber
                        formControlName="iFamiliarDireccionPiso"
                        maxlength="3"
                        useGrouping="false"
                        showButtons="true"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Manzana</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionManzana"
                        maxlength="10"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Lote</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionLote"
                        maxlength="3"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-4 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Km</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionKm"
                        maxlength="10"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 lg:col-8 md:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>Referencia</p-inputGroupAddon>
                    <input
                        type="text"
                        pInputText
                        formControlName="cFamiliarDireccionReferencia"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>

    <br />

    <p-fieldset legend="Ubigeo" [toggleable]="true">
        <div class="grid p-fluid mt-3">
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Departamento</p-inputGroupAddon>
                    <p-dropdown
                        [options]="departamentos"
                        formControlName="iDptoId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Provincia</p-inputGroupAddon>
                    <p-dropdown
                        [options]="provincias"
                        formControlName="iPrvnId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>

            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Distrito</p-inputGroupAddon>
                    <p-dropdown
                        [options]="distritos"
                        formControlName="iDsttId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Domicilio</p-inputGroupAddon>
                    <input
                        pInputText
                        formControlName="cPersDomicilio"
                        class="group-element"
                    />
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>

    <br />

    <p-fieldset legend="Adicionales" [toggleable]="true">
        <div class="grid p-fluid mt-3">
            <div class="col-12">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon> Ocupación </p-inputGroupAddon>
                    <p-dropdown
                        [options]="ocupaciones"
                        formControlName="iOcupacionId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>
                        Grado de instrucción
                    </p-inputGroupAddon>
                    <p-dropdown
                        [options]="grados_instruccion"
                        formControlName="iGradoInstId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
            <div class="col-12 sm:col-6">
                <p-inputGroup styleClass="vertical-group">
                    <p-inputGroupAddon>
                        I.E. en la que estudió
                    </p-inputGroupAddon>
                    <p-dropdown
                        [options]="tipos_ies"
                        formControlName="iTipoIeEstId"
                        [filter]="true"
                        [showClear]="true"
                        [appendTo]="'body'"
                        placeholder="Seleccione"
                        styleClass="group-element"
                    />
                </p-inputGroup>
            </div>
        </div>
    </p-fieldset>
</form>

<br />

<div class="flex justify-content-end gap-2">
    <p-button
        label="Salir sin guardar"
        severity="secondary"
        icon="pi pi-fw pi-arrow-left"
        (onClick)="salirResetearForm()"
    />
    <p-button
        label="Guardar y salir"
        severity="success"
        icon="pi pi-fw pi-save"
        (onClick)="guardarFamiliar()"
        [hidden]="familiar_registrado"
    />
    <p-button
        label="Actualizar y salir"
        severity="success"
        icon="pi pi-fw pi-save"
        (onClick)="actualizarFamiliar()"
        [hidden]="!familiar_registrado"
    />
</div>
