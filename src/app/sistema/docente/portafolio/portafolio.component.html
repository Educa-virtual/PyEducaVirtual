<div class="grid">
  <p-toolbar class="col-12">
    <div class="block">
      <h2 class="text-white font-bold block">Mi portafolio</h2>
      <div class="text-white font-bold block"></div>
    </div>
    <div class="p-toolbar-group-end">
      <!-- <p-button icon="pi pi-undo" [rounded]="true" pTooltip="Regresar" tooltipPosition="top" ]="['../..']" /> -->
    </div>
  </p-toolbar>
</div>
<div class="card">
  <div class="grid">
    <div class="col-12">
      <h4 class="text-primary"><i class="pi pi-list"></i>&nbsp;Itinerario</h4>
    </div>
    <div class="col-12">
      <p-inputGroup>
        <p-inputGroupAddon>
          <i class="pi pi-link" style="color: #333437"></i>
        </p-inputGroupAddon>
        <input
          type="text"
          pInputText
          [placeholder]="
            cPortafolioItinerario.length
              ? cPortafolioItinerario[0]['name']
              : 'Nombre del Itinerario'
          "
          disabled
          class="w-full p-inputtext-sm opacity-100"
          pInputText
        />
        <button
          pButton
          pRipple
          type="button"
          severity="primary"
          class="p-button-primary btn-file-image"
        >
          <i class="pi pi-upload"></i
          ><input
            type="file"
            (change)="onUploadChange($event, 'itinerario', null)"
            accept=".pdf "
          />
        </button>
        <button
          type="button"
          (click)="openLink(cPortafolioItinerario.length ? cPortafolioItinerario[0]['ruta'] : null)"
          [disabled]="!cPortafolioItinerario"
          pButton
          icon="pi pi-eye"
          class="p-button-info"
        >
          &nbsp;
        </button>
      </p-inputGroup>
    </div>
    <div class="col-12">
      <h4 class="text-primary"><i class="pi pi-book"></i>&nbsp;Reglamento Interno</h4>
    </div>
    <div class="col-12">
      <p-inputGroup>
        <p-inputGroupAddon>
          <i class="pi pi-link" style="color: #333437"></i>
        </p-inputGroupAddon>
        <input
          type="text"
          pInputText
          [placeholder]="reglamento.length ? reglamento[0]['name'] : 'Nombre de la resolución'"
          disabled
          class="w-full p-inputtext-sm opacity-100"
          pInputText
        />
        <button
          type="button"
          pButton
          icon="pi pi-eye"
          class="p-button-info"
          (click)="openLink(reglamento.length ? reglamento[0]['path'] : null)"
        >
          &nbsp;
        </button>
      </p-inputGroup>
    </div>
    @for (item of cursos; track item) {
      <p-panel class="col-12" [toggleable]="true" [collapsed]="true">
        <ng-template pTemplate="header">
          <div class="flex align-items-center gap-2">
            <span class="text-primary font-bold">
              {{ item.cCursoNombre }} ({{ item.cGradoNombre }}-{{ item.cSeccionNombre }})
            </span>
          </div>
        </ng-template>

        <div class="grid m-0">
          <div class="col-12 mb-1">
            @for (ficha of item.cCuadernoUrl; track ficha.typePortafolio) {
              @if (ficha.typePortafolio === 1) {
                <p class="text-primary">
                  <i class="pi pi-list"></i>&nbsp;Ficha de Actividades de Aprendizaje
                </p>
                <p-inputGroup>
                  <p-inputGroupAddon>
                    <i class="pi pi-link" style="color: #333437"></i>
                  </p-inputGroupAddon>
                  <input
                    type="text"
                    pInputText
                    [placeholder]="ficha.name ? ficha.name : 'Fichas de Actividades de Aprendizaje'"
                    disabled
                    class="w-full p-inputtext-sm opacity-100"
                    pInputText
                  />
                  <button
                    pButton
                    pRipple
                    type="button"
                    severity="primary"
                    class="p-button-primary btn-file-image"
                  >
                    <i class="pi pi-upload"></i
                    ><input
                      type="file"
                      (change)="onUploadChange($event, 'fichas-aprendizaje', item)"
                      accept=".pdf "
                    />
                  </button>
                  <button
                    type="button"
                    (click)="openLink(ficha.ruta)"
                    pButton
                    icon="pi pi-eye"
                    class="p-button-info"
                  >
                    &nbsp;
                  </button>
                </p-inputGroup>
              }
              @if (ficha.typePortafolio === 2) {
                <p class="text-primary mt-2"><i class="pi pi-list"></i>&nbsp;Cuaderno de Campo</p>
                <p-inputGroup class="mt-3">
                  <p-inputGroupAddon>
                    <i class="pi pi-link" style="color: #333437"></i>
                  </p-inputGroupAddon>
                  <input
                    type="text"
                    pInputText
                    [placeholder]="ficha.name ? ficha.name : 'Cuadernos de Campo'"
                    disabled
                    class="w-full p-inputtext-sm opacity-100"
                    pInputText
                  />
                  <button
                    pButton
                    pRipple
                    type="button"
                    severity="primary"
                    class="p-button-primary btn-file-image"
                  >
                    <i class="pi pi-upload"></i
                    ><input
                      type="file"
                      (change)="onUploadChange($event, 'cuadernos-campo', item)"
                      accept=".pdf "
                    />
                  </button>
                  <button
                    type="button"
                    (click)="openLink(ficha.ruta)"
                    pButton
                    icon="pi pi-eye"
                    class="p-button-info"
                  >
                    &nbsp;
                  </button>
                </p-inputGroup>
              }
              @if (ficha.typePortafolio === 3) {
                <p class="text-primary mt-2">
                  <i class="pi pi-list"></i>&nbsp;Instrumentos de Evaluación
                </p>
                <p-inputGroup class="mt-3">
                  <p-inputGroupAddon>
                    <i class="pi pi-link" style="color: #333437"></i>
                  </p-inputGroupAddon>
                  <input
                    type="text"
                    pInputText
                    [placeholder]="ficha.name ? ficha.name : 'Instrumentos de Evaluación'"
                    disabled
                    class="w-full p-inputtext-sm opacity-100"
                    pInputText
                  />
                  <button
                    pButton
                    pRipple
                    type="button"
                    severity="primary"
                    class="p-button-primary btn-file-image"
                  >
                    <i class="pi pi-upload"></i
                    ><input
                      type="file"
                      (change)="onUploadChange($event, 'instrumentos-evaluacion', item)"
                      accept=".pdf "
                    />
                  </button>
                  <button
                    type="button"
                    (click)="openLink(ficha.ruta)"
                    pButton
                    icon="pi pi-eye"
                    class="p-button-info"
                  >
                    &nbsp;
                  </button>
                </p-inputGroup>
              }
            }
            @if (!item.bFichas) {
              <p class="text-primary">
                <i class="pi pi-list"></i>&nbsp;Ficha de Actividades de Aprendizaje
              </p>
              <p-inputGroup>
                <p-inputGroupAddon>
                  <i class="pi pi-link" style="color: #333437"></i>
                </p-inputGroupAddon>
                <input
                  type="text"
                  pInputText
                  placeholder="Fichas de Actividades de Aprendizaje"
                  disabled
                  class="w-full p-inputtext-sm opacity-100"
                  pInputText
                />
                <button
                  pButton
                  pRipple
                  type="button"
                  severity="primary"
                  class="p-button-primary btn-file-image"
                >
                  <i class="pi pi-upload"></i
                  ><input
                    type="file"
                    (change)="onUploadChange($event, 'fichas-aprendizaje', item)"
                    accept=".pdf "
                  />
                </button>
                <button
                  type="button"
                  disabled="true"
                  pButton
                  icon="pi pi-eye"
                  class="p-button-info"
                >
                  &nbsp;
                </button>
              </p-inputGroup>
            }
            @if (!item.bCuadernos) {
              <p class="text-primary mt-2"><i class="pi pi-list"></i>&nbsp;Cuadernos de Campo</p>
              <p-inputGroup class="mt-3">
                <p-inputGroupAddon>
                  <i class="pi pi-link" style="color: #333437"></i>
                </p-inputGroupAddon>
                <input
                  type="text"
                  pInputText
                  placeholder="Cuadernos de Campo"
                  disabled
                  class="w-full p-inputtext-sm opacity-100"
                  pInputText
                />
                <button
                  pButton
                  pRipple
                  type="button"
                  severity="primary"
                  class="p-button-primary btn-file-image"
                >
                  <i class="pi pi-upload"></i
                  ><input
                    type="file"
                    (change)="onUploadChange($event, 'cuadernos-campo', item)"
                    accept=".pdf "
                  />
                </button>
                <button
                  type="button"
                  disabled="true"
                  pButton
                  icon="pi pi-eye"
                  class="p-button-info"
                >
                  &nbsp;
                </button>
              </p-inputGroup>
            }
            @if (!item.binstrumentos) {
              <p class="text-primary mt-2">
                <i class="pi pi-list"></i>&nbsp;Instrumentos de Evaluación
              </p>
              <p-inputGroup class="mt-3">
                <p-inputGroupAddon>
                  <i class="pi pi-link" style="color: #333437"></i>
                </p-inputGroupAddon>
                <input
                  type="text"
                  pInputText
                  placeholder="Instrumentos de Evaluación"
                  disabled
                  class="w-full p-inputtext-sm opacity-100"
                  pInputText
                />
                <button
                  pButton
                  pRipple
                  type="button"
                  severity="primary"
                  class="p-button-primary btn-file-image"
                >
                  <i class="pi pi-upload"></i
                  ><input
                    type="file"
                    (change)="onUploadChange($event, 'instrumentos-evaluacion', item)"
                    accept=".pdf "
                  />
                </button>
                <button
                  type="button"
                  disabled="true"
                  pButton
                  icon="pi pi-eye"
                  class="p-button-info"
                >
                  &nbsp;
                </button>
              </p-inputGroup>
            }
          </div>
          <div class="col-12 mt-1">
            <p class="text-primary"><i class="pi pi-list"></i>&nbsp;Registro de Evaluación</p>
            <p-inputGroup>
              <p-inputGroupAddon>
                <i class="pi pi-link" style="color: #333437"></i>
              </p-inputGroupAddon>
              <input
                type="text"
                pInputText
                placeholder="Registro de evaluación"
                disabled
                class="w-full p-inputtext-sm opacity-100"
                pInputText
              />
              <button
                type="button"
                pButton
                icon="pi pi-eye"
                class="p-button-info"
                (click)="getCursosDocente(item)"
              >
                &nbsp;
              </button>
            </p-inputGroup>
          </div>
        </div>
      </p-panel>
    }
  </div>
</div>

<p-dialog
  [(visible)]="showModalRubricas"
  [style]="{ width: '80%' }"
  header="Lista de Instrumentos de Evaluación"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  (onHide)="showModalRubricas = false"
>
  <div class="mt-3">
    <p-button
      class="mb-3"
      icon="pi pi-plus"
      label="Agregar"
      (click)="nuevaRubrica = true; eventoRubrica = false"
    ></p-button>
    <app-table-primeng
      [data]="rubricasCurso"
      [columnas]="columnasTabla"
      [actions]="accionesTabla"
      (accionBtnItem)="accionBnt($event)"
    ></app-table-primeng>
  </div>
</p-dialog>

<p-dialog
  [(visible)]="nuevaRubrica"
  [style]="{ width: '50%' }"
  [header]="(!eventoRubrica ? 'Guardar' : 'Editar') + ' Instrumentos de Evaluación'"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  (onHide)="nuevaRubrica = false; limpiar()"
>
  <div class="mt-3">
    <p-inputGroup class="mb-5">
      <p-inputGroupAddon> Instrumento de Evaluación</p-inputGroupAddon>
      <input type="text" [(ngModel)]="portafolio.cInstrumentoNombre" pInputText />
    </p-inputGroup>
    <p-floatLabel class="mb-3">
      <textarea
        class="w-full"
        [(ngModel)]="portafolio.cInstrumentoDescripcion"
        id="float-input"
        pInputTextarea
      ></textarea>
      <label for="float-input">Descripcion</label>
    </p-floatLabel>
    <p-divider type="solid" />
    <p-button
      *ngIf="eventoRubrica"
      severity="success"
      icon="pi pi-save"
      label="Editar"
      (click)="editarInstrumentos()"
    ></p-button>
    <p-button
      *ngIf="!eventoRubrica"
      severity="success"
      icon="pi pi-save"
      label="Guardar"
      (click)="agregarInstrumentos()"
    ></p-button>
  </div>
</p-dialog>

<p-toast></p-toast>
