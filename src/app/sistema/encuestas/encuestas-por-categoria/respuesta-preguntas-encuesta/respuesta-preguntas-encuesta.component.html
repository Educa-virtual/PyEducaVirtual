<div class="flex flex-wrap justify-content-between align-items-center mb-4 gap-3">
  <div class="flex align-items-center gap-3">
    <div class="flex align-items-center gap-2">
      <p-inputGroup class="flex-1">
        <p-inputGroupAddon>Participantes</p-inputGroupAddon>
        <p-dropdown
          [options]="participantesOptions"
          [(ngModel)]="participantesSeleccionados"
          (onChange)="onParticipanteChange($event.value)"
          optionLabel="label"
          optionValue="value"
          [style]="{ 'min-width': '200px' }"
          placeholder="Seleccionar"
        >
        </p-dropdown>
      </p-inputGroup>
    </div>

    <!-- Botones de exportaciÃ³n -->
    <div class="flex gap-2">
      <p-button
        icon="pi pi-file-excel"
        label="Excel"
        severity="success"
        size="small"
        (onClick)="exportarExcel()"
      >
      </p-button>
      <p-button
        icon="pi pi-file-pdf"
        label="PDF"
        severity="danger"
        size="small"
        (onClick)="exportarPDF()"
      >
      </p-button>
    </div>
  </div>

  <div class="flex align-items-center gap-2">
    <span class="text-lg font-medium text-600">Total de Respuestas</span>
    <p-badge [value]="totalRespuestas" severity="info" size="large" class="text-xl"> </p-badge>
  </div>
</div>

<div class="container-page" *ngIf="participantesSeleccionados === 'Todos'">
  <p-accordion [multiple]="true" [activeIndex]="[0]" styleClass="w-full">
    <p-accordionTab
      *ngFor="let seccion of secciones; let i = index"
      [header]="seccion.titulo"
      [selected]="seccion.expandida"
    >
      <div class="p-4" *ngIf="seccion.preguntas.length > 0">
        <div *ngFor="let pregunta of seccion.preguntas; let j = index" class="mb-6">
          <div class="flex justify-content-between align-items-start mb-3">
            <h3 class="text-lg font-medium text-900 m-0">{{ j + 1 }}. {{ pregunta.pregunta }}</h3>
            <span class="text-primary font-medium">
              {{ pregunta.totalRespuestas }} respuestas
            </span>
          </div>
          <div *ngIf="pregunta.tipo === 'chart'" class="chart-container">
            <p-chart
              type="bar"
              [data]="getChartData(pregunta.datos)"
              [options]="getChartOptions()"
              [style]="{ height: '300px', width: '100%' }"
            >
            </p-chart>
          </div>

          <div *ngIf="pregunta.tipo === 'pie'" class="chart-container">
            <p-chart
              type="doughnut"
              [data]="getPieData(pregunta.datos)"
              [options]="getPieOptions()"
              [style]="{ height: '300px', width: '100%' }"
            >
            </p-chart>
          </div>

          <p-divider *ngIf="j < seccion.preguntas.length - 1"></p-divider>
        </div>
      </div>
      <div *ngIf="seccion.preguntas.length === 0" class="p-4 text-center">
        <i class="pi pi-info-circle text-4xl text-400 mb-3"></i>
        <p class="text-600 text-lg">No hay preguntas disponibles en esta secciÃ³n</p>
      </div>
    </p-accordionTab>
  </p-accordion>
</div>
<div class="container-page" *ngIf="participantesSeleccionados !== 'Todos'">
  <app-pregunta-visualizacion [participanteSeleccionado]="participantesSeleccionados">
  </app-pregunta-visualizacion>
</div>
