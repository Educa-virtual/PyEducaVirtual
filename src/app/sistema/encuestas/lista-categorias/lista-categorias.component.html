<p-breadcrumb class="max-w-full" [model]="breadCrumbItems" [home]="breadCrumbHome" />

<p-panel>
  <ng-template pTemplate="header">
    <span class="text-2xl text-uppercase"> Gestionar categorías de encuestas </span>
  </ng-template>
  <ng-template pTemplate="icons" class="flex justify-content-center">
    <button
      pButton
      pRipple
      label="Nueva"
      icon="pi pi-plus"
      class="p-button-success"
      (click)="abrirDialogNuevaCategoria()"
    ></button>
  </ng-template>

  <div class="grid">
    <div class="col-12">
      <p-inputGroup>
        <p-inputGroupAddon> Buscar </p-inputGroupAddon>
        <input #filtro type="text" pInputText (input)="filtrarTabla()" />
      </p-inputGroup>
    </div>
  </div>

  @if (!categorias || categorias.length === 0) {
    <app-no-data [showIcon]="'NO-DATA'" mensaje="No hay categorías disponibles" />
  } @else {
    <p-dataView [rows]="10" [paginator]="true" [value]="categorias">
      <ng-template pTemplate="list" let-categorias>
        <div class="categorias-grid">
          <div *ngFor="let categoria of categorias" class="categoria-item">
            <article
              class="card p-0 border-1 flex flex-column surface-border overflow-hidden h-full post-module"
            >
              <div class="curso__image-container img-transition">
                <img
                  [alt]="categoria.cCateNombre"
                  class="w-full h-full"
                  (error)="updateUrl(categoria)"
                />
              </div>
              <div class="p-3 mb-auto">
                <h3 class="text-xl">
                  {{ categoria.cCateNombre | uppercase }}
                </h3>
              </div>
              <footer class="p-3 pt-0 flex align-items-center justify-content-between">
                <p>
                  {{ categoria.iTotalEncuestas }}
                  {{ categoria.iTotalEncuestas === 1 ? 'encuesta' : 'encuestas' }}
                </p>
                <a
                  [routerLink]="['/encuestas/categorias', categoria.iCateId, 'encuestas']"
                  style="color: white"
                  class="p-button p-component p-button-primary p-button-sm p-button-rounded"
                >
                  Acceder
                </a>
              </footer>
            </article>
          </div>
        </div>
      </ng-template>
    </p-dataView>
  }
</p-panel>

<app-nueva-categoria
  [(visible)]="mostrarDialogNuevaCategoria"
  (categoriaCreada)="onCategoriaCreada($event)"
></app-nueva-categoria>

<p-toast></p-toast>
