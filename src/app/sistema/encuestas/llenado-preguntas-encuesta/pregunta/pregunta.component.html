<p-dialog
  header="Agregar seccion"
  [(visible)]="visible"
  (onHide)="onHide()"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  styleClass="nueva-categoria-dialog"
  [style]="{ width: '700px', height: '350px' }"
>
  <div class="dialog-content">
    <div class="pregunta-content">
      <div>
        <label for="pregunta" class="block mb-2 font-semibold">
          Pregunta
          <span class="text-red-500 text-xs">(*) Obligatorio</span>
        </label>
        <editor
          class="w-full"
          [init]="initEnunciado"
          class="w-full"
          placeholder="Escriba la pregunta aquí.."
        >
        </editor>
        <!--<p-editor
                            class="w-full"
                            placeholder="Escriba la pregunta aquí..."
                            [(ngModel)]="pregunta.cPregunta"
                        >
                        </p-editor>-->
      </div>
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="mb-3" style="width: 130%; max-width: none">
            @for (
              alternativa of pregunta?.alternativas;
              track alternativa?.iAlternativaId;
              let idx = $index
            ) {
              <div
                class="alternativa-item p-2 mb-2 border-round"
                [ngStyle]="{
                  'border-left': alternativa.bAlternativaCorrecta ? '4px solid #22c55e' : 'inherit',
                  background: alternativa.bAlternativaCorrecta ? 'rgb(227 253 237)' : 'transparent',
                }"
              >
                <p-inputGroup class="mt-1">
                  <p-inputGroupAddon>
                    {{ alternativa.cAlternativaLetra }}
                  </p-inputGroupAddon>
                  <input
                    type="text"
                    pInputText
                    [(ngModel)]="alternativa.cAlternativaDescripcion"
                    placeholder="Ingrese la alternativa"
                  />
                </p-inputGroup>

                <div class="flex justify-content-end">
                  <p-button
                    icon="pi pi-trash"
                    severity="danger"
                    size="small"
                    [text]="true"
                    (onClick)="eliminarAlternativa(pregunta, idx)"
                    *ngIf="pregunta.alternativas.length > 2"
                  >
                  </p-button>
                  <p-checkbox
                    [label]="'Respuesta correcta'"
                    [inputId]="alternativa.iAlternativaId?.toString() || 'alt_' + idx"
                    [value]="alternativa"
                    [(ngModel)]="alternativa.bAlternativaCorrecta"
                    [binary]="true"
                    (onChange)="
                      cambiarEstadoCheckbox(
                        alternativa.iAlternativaId || idx,
                        pregunta.alternativas
                      )
                    "
                  >
                  </p-checkbox>
                </div>

                @if (alternativa.bAlternativaCorrecta) {
                  <p-inputGroup class="mt-1">
                    <p-inputGroupAddon>Explicación</p-inputGroupAddon>
                    <input
                      type="text"
                      pInputText
                      [(ngModel)]="alternativa.cAlternativaExplicacion"
                      placeholder="Explicación de por qué la respuesta es correcta"
                    />
                  </p-inputGroup>
                }
              </div>
            }

            <div class="text-center mt-2">
              <p-button
                icon="pi pi-plus"
                label="Añadir alternativa"
                severity="primary"
                size="small"
                (onClick)="agregarAlternativa(pregunta)"
              >
              </p-button>
            </div>
          </div>
        </div>
        <div class="col-12 md:col-6">
          <div class="flex justify-content-center align-items-center h-full">
            <p-button label="Adjuntar" severity="success" icon="pi pi-paperclip"></p-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</p-dialog>
