<!-- Breadcrumb -->
<p-breadcrumb
    class="max-w-full mb-4"
    [model]="breadCrumbItems"
    [home]="breadCrumbHome"
></p-breadcrumb>

<!-- Panel principal -->
<p-panel>
    <ng-template pTemplate="header">
        <div class="flex flex-column gap-2">
            <h3 class="m-0 text-uppercase text-primary">{{ title }}</h3>
        </div>
    </ng-template>

    <!-- Buscador -->
    <div class="flex align-items-center gap-2 mb-4">
        <span class="p-input-icon-left flex-1" style="max-width: 400px">
            <i class="pi pi-search"></i>
            <input
                type="text"
                pInputText
                [(ngModel)]="terminoBusqueda"
                (input)="filtrarRecursos()"
                placeholder="Buscar por área..."
                class="w-full"
                style="padding-left: 2.5rem"
            />
        </span>
        <p-button
            *ngIf="terminoBusqueda"
            icon="pi pi-times"
            [text]="true"
            (click)="limpiarBusqueda()"
            pTooltip="Limpiar búsqueda"
            styleClass="p-button-rounded p-button-text"
        ></p-button>
    </div>

    <!-- Tabla 2º Grado -->
    <p-panel class="mb-4">
        <ng-template pTemplate="header">
            <h4 class="m-0 text-primary">2º Grado</h4>
        </ng-template>

        <p-table
            [value]="datosRecursosFiltrados"
            [tableStyle]="{ 'min-width': '50rem' }"
            styleClass="p-datatable-sm"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th *ngFor="let col of cols" style="text-align: center">
                        {{ col.header }}
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-recurso>
                <tr>
                    <td style="text-align: center">{{ recurso.id }}</td>
                    <td>{{ recurso.area }}</td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Cuadernillo', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="
                                descargarPDF('Hoja de respuestas', recurso)
                            "
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Matriz', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            [label]="estadosRecurso[recurso.estado].label"
                            [icon]="estadosRecurso[recurso.estado].icon"
                            [severity]="estadosRecurso[recurso.estado].severity"
                            size="small"
                            iconPos="right"
                            (click)="
                                ejecutarAccion(
                                    estadosRecurso[recurso.estado].accion,
                                    recurso
                                )
                            "
                        ></p-button>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td [attr.colspan]="cols.length" class="text-center p-4">
                        <i class="pi pi-search text-4xl text-400 mb-3"></i>
                        <p class="text-500 m-0">
                            No se encontraron áreas que coincidan con la
                            búsqueda
                        </p>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>

    <!-- Tabla 4º Grado -->
    <p-panel class="mb-4">
        <ng-template pTemplate="header">
            <h4 class="m-0 text-primary">4º Grado</h4>
        </ng-template>

        <p-table
            [value]="datosRecursos4toFiltrados"
            [tableStyle]="{ 'min-width': '50rem' }"
            styleClass="p-datatable-sm"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th *ngFor="let col of cols" style="text-align: center">
                        {{ col.header }}
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-recurso>
                <tr>
                    <td style="text-align: center">{{ recurso.id }}</td>
                    <td>{{ recurso.area }}</td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Cuadernillo', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="
                                descargarPDF('Hoja de respuestas', recurso)
                            "
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Matriz', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            [label]="
                                obtenerConfiguracionEstado(recurso.estado).label
                            "
                            [icon]="
                                obtenerConfiguracionEstado(recurso.estado).icon
                            "
                            [severity]="
                                obtenerConfiguracionEstado(recurso.estado)
                                    .severity
                            "
                            size="small"
                            iconPos="right"
                            (click)="
                                ejecutarAccion(
                                    obtenerConfiguracionEstado(recurso.estado)
                                        .accion,
                                    recurso
                                )
                            "
                        ></p-button>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td [attr.colspan]="cols.length" class="text-center p-4">
                        <i class="pi pi-search text-4xl text-400 mb-3"></i>
                        <p class="text-500 m-0">
                            No se encontraron áreas que coincidan con la
                            búsqueda
                        </p>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>

    <!-- Tabla 6º Grado -->
    <p-panel class="mb-4">
        <ng-template pTemplate="header">
            <h4 class="m-0 text-primary">6º Grado</h4>
        </ng-template>

        <p-table
            [value]="datosRecursos6toFiltrados"
            [tableStyle]="{ 'min-width': '50rem' }"
            styleClass="p-datatable-sm"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th *ngFor="let col of cols" style="text-align: center">
                        {{ col.header }}
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-recurso>
                <tr>
                    <td style="text-align: center">{{ recurso.id }}</td>
                    <td>{{ recurso.area }}</td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Cuadernillo', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="
                                descargarPDF('Hoja de respuestas', recurso)
                            "
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            label="PDF"
                            icon="pi pi-file-pdf"
                            severity="danger"
                            size="small"
                            (click)="descargarPDF('Matriz', recurso)"
                        ></p-button>
                    </td>
                    <td style="text-align: center">
                        <p-button
                            [label]="
                                obtenerConfiguracionEstado(recurso.estado).label
                            "
                            [icon]="
                                obtenerConfiguracionEstado(recurso.estado).icon
                            "
                            [severity]="
                                obtenerConfiguracionEstado(recurso.estado)
                                    .severity
                            "
                            size="small"
                            iconPos="right"
                            (click)="
                                ejecutarAccion(
                                    obtenerConfiguracionEstado(recurso.estado)
                                        .accion,
                                    recurso
                                )
                            "
                        ></p-button>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td [attr.colspan]="cols.length" class="text-center p-4">
                        <i class="pi pi-search text-4xl text-400 mb-3"></i>
                        <p class="text-500 m-0">
                            No se encontraron áreas que coincidan con la
                            búsqueda
                        </p>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-panel>
</p-panel>

<app-dialog-generar-cuadernillo
    [(mostrarDialogoEdicion)]="mostrarDialogoEdicion"
></app-dialog-generar-cuadernillo>

<!-- Toast para mensajes -->
<p-toast></p-toast>
