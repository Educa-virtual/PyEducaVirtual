<ngx-doc-viewer [url]="pdfUrl" viewer="pdf"></ngx-doc-viewer>
<p-panel styleClass="container-page">
    <ng-template pTemplate="header" class="encabezado">
        <div class="flex flex-column gap-2">
            <h3 class="m-0 text-uppercase text-primary">
                Evaluación ERE: {{ cEvaluacionNombre || '-' }} -
                {{ cCursoNombre || '-' }}
            </h3>
        </div>
    </ng-template>
    <ng-template pTemplate="icons" class="flex flex-column flex-1">
        <div class="flex flex-wrap gap-2 justify-content-end">
            <p>Tiempo restante: {{ getTiempoFormateado() }}</p>
        </div>
    </ng-template>
    <div class="grid">
        <div class="col-12 py-2" *ngIf="preguntas.length">
            <p-progressBar [value]="75" />
        </div>

        <!-- <div class="flex mb-3 gap-2 justify-content-end">
            <p-button
                *ngFor="let index of preguntas"
                (click)="activeIndex = index"
                [rounded]="true"
                [label]="index + 1 + ''"
                styleClass="w-2rem h-2rem p-0"
                [outlined]="activeIndex !== index"
            />
        </div> -->

        <p-accordion class="col-12" [activeIndex]="activeIndex">
            <p-accordionTab
                [header]="tab.title | removeHTMLCSS | truncateText: 120"
                *ngFor="let tab of preguntas; let i = index"
            >
                <!-- pregunta multiple -->
                <div *ngIf="tab.iEncabPregId">
                    <div class="grid">
                        <div class="card col-6">
                            <!-- {{Imprimir el enunciado}} -->
                            <div [innerHTML]="tab.cEncabPregContenido"></div>
                        </div>
                        <div class="card col-6">
                            <!-- Mostrar las sub-preguntas de la pregunta multiple -->
                            <p-accordion [multiple]="true">
                                <p-accordionTab
                                    [header]="
                                        pregunta.title
                                            | removeHTMLCSS
                                            | truncateText: 60
                                    "
                                    *ngFor="let pregunta of tab.pregunta"
                                >
                                    <div [innerHTML]="pregunta.cPregunta"></div>
                                    <ul>
                                        <li
                                            *ngFor="
                                                let opcion of pregunta.alternativas;
                                                let i = index
                                            "
                                            [class.seleccionado]="
                                                opcion === seleccion
                                            "
                                        >
                                            <p-radioButton
                                                name="opciones"
                                                [value]="opcion"
                                                [(ngModel)]="seleccion"
                                            >
                                            </p-radioButton>
                                            <p class="ml-2">
                                                <!-- {{ getLetra(i) }}.--->
                                                {{
                                                    opcion.cAlternativaDescripcion
                                                }}
                                            </p>
                                        </li>
                                    </ul>
                                </p-accordionTab>
                            </p-accordion>
                            <!-- <div class="displey flex">
                                <div class="col-10 backColor p-4">
                                    <span class="font-bold text-xl flex gap-2">
                                        Texto de ayuda:
                                    </span>
                                    <p class="flex gap-2 flex-wrap">
                                        Tu eres muy inteligente,, no vas poner jajaj
                                    </p>
                                </div>
                                <div class="col-2 p-4">
                                    <p-button icon="pi pi-arrow-right" [rounded]="true" [outlined]="true"
                                        (click)="siguientePregunta(i)" />
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>

                <!-- Mostrar preguntas Unicas -->
                <div *ngIf="!tab.iEncabPregId">
                    <div *ngFor="let pregunta of tab.pregunta">
                        <div [innerHTML]="pregunta.cPregunta"></div>
                        <ul>
                            <li
                                *ngFor="
                                    let opcion of pregunta.alternativas;
                                    let i = index
                                "
                                [class.seleccionado]="opcion === seleccion"
                            >
                                <p-radioButton
                                    name="opciones"
                                    [value]="opcion"
                                    [(ngModel)]="seleccion"
                                >
                                </p-radioButton>
                                <p class="ml-2">
                                    {{ opcion.cAlternativaDescripcion }}
                                </p>
                            </li>
                        </ul>
                    </div>
                    <div class="displey flex">
                        <!-- <div class="col-11 backColor p-4">
                            <span class="font-bold text-xl flex gap-2">
                                Texto de ayuda:
                            </span>
                            <p class="flex gap-2 flex-wrap">
                                Tu eres muy inteligente, no vas poner jajaj
                            </p>
                        </div> -->
                        <!-- <div class="col-1 p-4 text-right">
                            <p-button icon="pi pi-arrow-right" [rounded]="true" [outlined]="true"
                                (click)="siguientePregunta(i)" />
                        </div> -->
                    </div>
                </div>
            </p-accordionTab>
        </p-accordion>
        <div class="col-12 text-center" *ngIf="preguntas.length">
            <p-button label="Terminar Exámen" severity="success" />
        </div>
    </div>
</p-panel>
<p-toast></p-toast>
