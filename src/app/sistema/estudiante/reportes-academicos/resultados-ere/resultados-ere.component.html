<p-breadcrumb class="max-w-full" [model]="breadCrumbItems" [home]="breadCrumbHome" />

<p-panel>
  <ng-template pTemplate="header">
    <div class="flex flex-column gap-2">
      <h3 class="m-0 text-uppercase text-primary">Resultados ERE</h3>
    </div>
  </ng-template>

  <div class="grid p-fluid mt-3">
    <div class="field col-12 md:col-4">
      <p-inputGroup>
        <p-inputGroupAddon class="mi-addon-primary">Año escolar:</p-inputGroupAddon>
        <input pInputText [value]="anioEscolar" disabled class="input-disabled" />
      </p-inputGroup>
    </div>
    <div class="field col-12 md:col-4">
      <p-inputGroup>
        <p-inputGroupAddon class="mi-addon-primary">Evaluación:</p-inputGroupAddon>
        <p-dropdown
          [options]="evaluaciones"
          optionLabel="cEvaluacionNombre"
          optionValue="iEvaluacionId"
          [appendTo]="'body'"
          [style]="{ flex: '1', width: '100%' }"
          placeholder="Seleccione..."
          [(ngModel)]="evaluacionSeleccionada"
          (onChange)="obtenerResultadosEstudiantePorEvaluacion()"
        />
      </p-inputGroup>
    </div>
    <!--<div class="field col-12 md:col-4">
      <p-inputGroup>
        <p-inputGroupAddon class="mi-addon-primary">Evaluación:</p-inputGroupAddon>
        <p-dropdown
          [options]="evaluaciones"
          optionLabel="cEvaluacionNombre"
          optionValue="iEvaluacionId"
          [appendTo]="'body'"
          [style]="{ flex: '1', width: '100%' }"
          placeholder="Seleccione..."
          [(ngModel)]="evaluacionSeleccionada"
          (onChange)="obtenerAreasPorEvaluacionEstudiante()"
        />
      </p-inputGroup>
    </div>
    <div class="field col-12 md:col-4">
      <p-inputGroup>
        <p-inputGroupAddon class="mi-addon-primary">Área:</p-inputGroupAddon>
        <p-dropdown
          [options]="areas"
          optionLabel="cCursoNombre"
          optionValue="iCursoId"
          [appendTo]="'body'"
          [style]="{ flex: '1', width: '100%' }"
          placeholder="Seleccione..."
          [(ngModel)]="areaSeleccionada"
        />
      </p-inputGroup>
    </div>-->
    <!--<div class="field col-12 md:col-2">
            <button pButton pRipple (click)="generarReporte()" icon="pi pi-chart-bar" label="Generar"
                class="p-button-success"></button>
        </div>-->
  </div>
  <small
    >Para cambiar el año escolar: en la barra superior de la pantalla, en Año Escolar, seleccione
    otra opción</small
  >

  <div class="grid p-fluid mt-3">
    <div class="col-12 md:col-7">
      <p-fieldset legend="Resultados de áreas curriculares" class="legend-rojo">
        <p class="m-0">
          <p-table [value]="resultado" styleClass="custom-table border-round w-full">
            <ng-template pTemplate="header">
              <tr>
                <th style="width: 5%" class="text-center">#</th>
                <th class="text-center">Área curricular</th>
                <th style="width: 15%" class="text-center">Aciertos</th>
                <th style="width: 15%" class="text-center">Desaciertos</th>
                <th style="width: 15%" class="text-center">En blanco</th>
                <th style="width: 15%" class="text-center">Resultado</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
              <tr>
                <td class="text-center">{{ rowIndex + 1 }}</td>
                <td class="text-center">{{ row.cCursoNombre }}</td>
                <td class="text-center">
                  {{ row.iCantidadCorrectas }}
                </td>
                <td class="text-center">
                  {{ row.iCantidadIncorrectas }}
                </td>
                <td class="text-center">
                  {{ row.iEnBlanco }}
                </td>
                <td class="text-center">
                  {{ row.cNivelLogro }}
                </td>
              </tr>
            </ng-template>
          </p-table>
        </p>
      </p-fieldset>
    </div>
    <div class="col-12 md:col-5">
      <p-fieldset legend="Gráfico por área curricular" class="legend-verde">
        <p class="m-0">
          <p-inputGroup>
            <p-inputGroupAddon class="mi-addon-primary">Área:</p-inputGroupAddon>
            <p-dropdown
              [options]="resultado"
              optionLabel="cCursoNombre"
              optionValue="iCursosNivelGradId"
              [appendTo]="'body'"
              [style]="{ flex: '1', width: '100%' }"
              placeholder="Seleccione..."
              [(ngModel)]="areaSeleccionada"
              (onChange)="onCourseChange()"
            />
          </p-inputGroup>
        </p>

        @if (areaSeleccionada !== null) {
          <div class="mt-3">
            <p-chart
              #uiChart
              type="bar"
              [data]="chartData"
              [options]="chartOptions"
              [plugins]="chartPlugins"
              [height]="'450'"
            ></p-chart>
          </div>
        }
      </p-fieldset>
    </div>
  </div>
</p-panel>
<p-toast></p-toast>
