<app-container-page-accionb
    [title]="'Agregar Evaluación'"
    [actions]="accionesPrincipal"
    (accionBtnItem)="accionBtnItem($event)"
    class="custom-container-page"
>
    <p-toast> </p-toast>
    <div class="card">
        <app-table-primeng
            [columnas]="columnas"
            [data]="data"
            (accionBtnItem)="accionBtnItemTable($event)"
            [(selectedRowData)]="selectedItems"
            [actions]="accionesTabla"
            [showPaginator]="true"
        >
        </app-table-primeng>
    </div>
    <!-- <app-container-preguntas
        [pregunta]="'¿Cuál es la capital de Francia?'"
        [alternativas]="['Madrid', 'París', 'Berlín', 'Roma', 'N/A']"
    >
    </app-container-preguntas> -->
</app-container-page-accionb>

<p-dialog
    #dialogBancoPreguntas
    header="Agregar fechas de Publicación ERE:  {{ cEvaluacionNombre }} "
    [modal]="true"
    [(visible)]="showModalCursosEre"
    [position]="'top'"
    [maximizable]="true"
    [style]="{ width: '80%' }"
>
    @defer (when showModalCursosEre) {
        <br />
        <div>Agregar fechas de Publicación Areas Curriculares</div>

        <div class="container" [formGroup]="form">
            <!-- "form" -->
            <!-- Card por cada nivel -->
            <div class="card mt-3" *ngFor="let nivel of listaCursos">
                <div class="card-header">
                    <h3 class="card-title">{{ nivel.cNivelTipoNombre }}</h3>
                </div>
                <div class="card-body">
                    <!-- Recorrer grados -->
                    <div *ngFor="let grado of nivel.grados">
                        <!-- <h4>{{ grado.grado }}</h4> -->
                        <ul class="list-unstyled m-0 p-0">
                            <!-- Recorrer cursos -->
                            <li
                                *ngFor="let curso of grado.cursos"
                                class="list-none"
                            >
                                <!-- Contenedor horizontal: Nombre del curso + calendarios -->
                                <div class="grid">
                                    <div
                                        class="flex align-content-center col-3"
                                    >
                                        <span
                                            class="curso-nombre"
                                            style="font-weight: bold"
                                        >
                                            {{ curso.cCursoNombre }}
                                        </span>

                                        <span> &nbsp; - &nbsp; </span>

                                        <!-- Grado del curso -->
                                        <span
                                            class="curso-grado"
                                            style="font-weight: normal"
                                        >
                                            {{
                                                grado.grado ??
                                                    grado.cGradoAbreviacion
                                            }}
                                            Grado
                                        </span>
                                    </div>

                                    <!-- Columna derecha: Calendarios de inicio y fin -->
                                    <div class="grid col-9">
                                        <!-- Calendario de inicio -->

                                        <div class="col-6">
                                            <p-inputGroup>
                                                <p-inputGroupAddon
                                                    >Hora de
                                                    Inicio</p-inputGroupAddon
                                                >
                                                <p-calendar
                                                    formControlName="{{
                                                        curso.cCursoNombre +
                                                            curso.iCursoNivelGradId
                                                    }}[{{
                                                        curso.iExamCurId
                                                    }}]Inicio"
                                                    [showTime]="true"
                                                    [hourFormat]="'24'"
                                                    [timeOnly]="false"
                                                    [showIcon]="true"
                                                    placeholder="Inicio"
                                                    inputId="fechaHoraInicio-{{
                                                        curso.cCursoNombre
                                                    }}"
                                                    [appendTo]="'body'"
                                                    styleClass="w-full"
                                                    class="calendar"
                                                ></p-calendar>
                                            </p-inputGroup>
                                        </div>

                                        <div class="col-6">
                                            <p-inputGroup>
                                                <p-inputGroupAddon
                                                    >Hora Fin</p-inputGroupAddon
                                                >
                                                <p-calendar
                                                    formControlName="{{
                                                        curso.cCursoNombre +
                                                            curso.iCursoNivelGradId
                                                    }}[{{
                                                        curso.iExamCurId
                                                    }}]Fin"
                                                    [showTime]="true"
                                                    [hourFormat]="'24'"
                                                    [timeOnly]="false"
                                                    [showIcon]="true"
                                                    placeholder="Fin"
                                                    inputId="fechaHoraFin-{{
                                                        curso.cCursoNombre
                                                    }}"
                                                    [appendTo]="'body'"
                                                    styleClass="w-full"
                                                ></p-calendar>
                                            </p-inputGroup>
                                        </div>
                                    </div>
                                </div>

                                <!-- Línea separadora para cada curso -->
                                <hr class="mt-3 mb-0" />
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <ng-template #noData>
            <p>No hay cursos disponibles para mostrar.</p>
        </ng-template>
    }
    <ng-template pTemplate="footer">
        <div class="flex justify-content-end gap-2 pt-3">
            <button
                pButton
                pRipple
                label="Cancelar"
                icon="pi pi-times"
                class="align-items-start p-button-secondary"
                type="button"
                size="small"
                (click)="ngOnDestroy()"
                (click)="showModalCursosEre = false"
                (click)="form.reset()"
                (click)="removeControls()"
            ></button>

            <button
                pButton
                pRipple
                label="Guardar"
                icon="pi pi-times"
                class="p-button-primary"
                type="button"
                size="small"
                (click)="guardarInicioFinalExmAreas()"
            ></button>
        </div>
    </ng-template>
</p-dialog>
