<br />

<app-container-page
    title="Listado de familiares"
    [actions]="accionesPrincipal"
    (accionBtnItem)="accionBtnItemTable($event)"
>
    <app-table-primeng
        [columnas]="columns"
        [showCaption]="true"
        [data]="familiares"
        (accionBtnItem)="accionBtnItemTable($event)"
        [showPaginator]="true"
        [(selectedRowData)]="selectedItems"
        [actions]="actions"
        [showAdvancedFilter]="true"
    >
    </app-table-primeng>
    <ng-container slot="caption-content"> </ng-container>
</app-container-page>

<p-dialog
    header="{{ caption }}"
    [(visible)]="visible"
    [style]="{ width: '56rem' }"
    [modal]="true"
    [contentStyle]="{ overflow: 'auto' }"
    (onClose)="clearForm()"
    (onShow)="setFormFamiliar()"
>
    <ng-content>
        <form [formGroup]="form">
            <div class="grid p-fluid mt-3">
                <input type="hidden" formControlName="iFamiliarId" />

                <br />

                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="tipos_familiares"
                            formControlName="iTipoFamiliarId"
                            optionLabel="nombre"
                            [checkmark]="true"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iTipoFamiliarId"
                            >Relación / Parentesco *</label
                        >
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="sexos"
                            formControlName="cPersSexo"
                            optionLabel="nombre"
                            [checkmark]="true"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="cPersSexo">Sexo *</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="estados_civiles"
                            formControlName="iTipoEstCivId"
                            optionLabel="nombre"
                            [checkmark]="true"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iTipoEstCivId">Estado Civil</label>
                    </span>
                </div>

                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="tipos_documentos"
                            formControlName="iTipoIdentId"
                            optionLabel="nombre"
                            [checkmark]="true"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iTipoIdentId">Tipo de documento *</label>
                    </span>
                </div>
                <div class="field col-6 md:col-4">
                    <span class="p-float-label">
                        <input
                            pInputText
                            id="cPersDocumento"
                            formControlName="cPersDocumento"
                            aria-describedby="cPersDocumento-help"
                        />
                        <label for="cPersDocumento">Documento *</label>
                    </span>
                </div>
                <div class="field col-6 md:col-4">
                    <p-button
                        label="Validar"
                        (onClick)="accionBtnItem('validar_')"
                        styleClass="p-button-warning"
                    />
                </div>

                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <input
                            pInputText
                            id="cPersNombre"
                            formControlName="cPersNombre"
                            aria-describedby="cPersNombre-help"
                        />
                        <label for="cPersNombre">Nombres *</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <input
                            pInputText
                            id="cPersPaterno"
                            formControlName="cPersPaterno"
                            aria-describedby="cPersPaterno-help"
                        />
                        <label for="cPersPaterno">Primer Apellido *</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <input
                            pInputText
                            id="cPersMaterno"
                            formControlName="cPersMaterno"
                            aria-describedby="cPersMaterno-help"
                        />
                        <label for="cPersMaterno">Segundo Apellido *</label>
                    </span>
                </div>

                <div class="field col-12 md:col-8">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="nacionalidades"
                            formControlName="iNacionId"
                            optionLabel="nombre"
                            [checkmark]="true"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="cPersPais">Nacionalidad</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-calendar
                            formControlName="dPersNacimiento"
                            [iconDisplay]="'input'"
                            [showIcon]="true"
                            inputId="dPersNacimiento"
                            [appendTo]="'body'"
                        />
                        <label for="dPersNacimiento"
                            >Fecha de nacimiento *</label
                        >
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="departamentos"
                            formControlName="iDptoId"
                            optionLabel="nombre"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iDptoId">Departamento</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="provincias"
                            formControlName="iPrvnId"
                            optionLabel="nombre"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iPrvnId">Provincia</label>
                    </span>
                </div>
                <div class="field col-12 md:col-4">
                    <span class="p-float-label">
                        <p-dropdown
                            [options]="distritos"
                            formControlName="iDsttId"
                            optionLabel="nombre"
                            optionValue="id"
                            [filter]="true"
                            [showClear]="true"
                            [appendTo]="'body'"
                        />
                        <label for="iDsttId">Distrito</label>
                    </span>
                </div>

                <div class="field col-12">
                    <span class="p-float-label">
                        <input
                            pInputText
                            formControlName="cPersDomicNombre"
                            aria-describedby="cPersDomicNombre-help"
                        />
                        <label for="cPersDireccion">Dirección</label>
                    </span>
                </div>
            </div>
        </form>

        <div class="flex justify-content-end">
            <p-button
                label="Guardar"
                (onClick)="guardarFarmiliar()"
                styleClass="p-button-primary"
                [hidden]="familiar_registrado"
            />
            <p-button
                label="Actualizar"
                (onClick)="actualizarFarmiliar()"
                styleClass="p-button-primary"
                [hidden]="!familiar_registrado"
            />
        </div>
    </ng-content>
</p-dialog>
<p-toast></p-toast>
