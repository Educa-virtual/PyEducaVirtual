<div class="grid mt-2">
    <div class="col-12 md:col-8">
        <ng-container *ngIf="selectedItems.length > 0; else sinSeleccion">
            <app-container-page
                title="Accesos de usuario IE"
                [actions]="accionesPrincipal"
                (accionBtnItem)="accionBtnItemTable($event)"
            >
                <form [formGroup]="form_search">
                    <div class="field grid mt-2">
                        <div class="col-6 md:col-6">
                            <span class="p-float-label">
                                <p-dropdown
                                    [style]="{ width: '100%' }"
                                    [options]="search_perfiles"
                                    [filter]="false"
                                    filterBy="cPerfilNombre"
                                    optionLabel="cPerfilNombre"
                                    optionValue="iPerfilId"
                                    formControlName="iPerfilId"
                                />
                                <label for="iPerfilId">Perfil</label>
                            </span>
                        </div>
                        <div class="col-3">
                            <button
                                pButton
                                [label]="'Filtro avanzado'"
                                icon="pi pi-filter"
                                size="small"
                                class="p-button-success"
                                (click)="
                                    btnItem(
                                        'searh_perfil',
                                        'Desea filtrar por perfil del sistema'
                                    )
                                "
                            ></button>
                        </div>
                        <div class="col-3">
                            <button
                                pButton
                                [label]="'Mostrar todo'"
                                icon="pi pi-search"
                                size="small"
                                class="p-button-primary"
                                (click)="
                                    btnItem(
                                        'searh_perfil_all',
                                        'Desea cargar todos los accesos'
                                    )
                                "
                            ></button>
                        </div>
                    </div>
                </form>
                <div class="card">
                    <app-table-primeng
                        [columnas]="columns"
                        [showCaption]="true"
                        [data]="lista_accesos"
                        (accionBtnItem)="accionBtnItemTable($event)"
                        [showPaginator]="true"
                        [(selectedRowData)]="selectedItems"
                        [actions]="actionsUsuario"
                        [ariaDisabled]="true"
                    >
                        <!-- <ng-container slot="caption-content"> </ng-container> -->
                    </app-table-primeng>
                </div>
            </app-container-page>
        </ng-container>
        <ng-template #sinSeleccion>
            <app-container-page
                title="Accesos de usuario IE"
                [actions]="[]"
                (accionBtnItem)="accionBtnItemTable($event)"
            >
                <form [formGroup]="form_search">
                    <div class="field grid mt-2">
                        <div class="col-6 md:col-6">
                            <span class="p-float-label">
                                <p-dropdown
                                    [style]="{ width: '100%' }"
                                    [options]="search_perfiles"
                                    [filter]="false"
                                    filterBy="cPerfilNombre"
                                    optionLabel="cPerfilNombre"
                                    optionValue="iPerfilId"
                                    formControlName="iPerfilId"
                                />
                                <label for="iPerfilId">Perfil</label>
                            </span>
                        </div>
                        <div class="col-3">
                            <button
                                pButton
                                [label]="'Filtro avanzado'"
                                icon="pi pi-filter"
                                size="small"
                                class="p-button-success"
                                (click)="
                                    btnItem(
                                        'searh_perfil',
                                        'Desea filtrar por perfil del sistema'
                                    )
                                "
                            ></button>
                        </div>
                        <div class="col-3">
                            <button
                                pButton
                                [label]="'Mostrar todo'"
                                icon="pi pi-search"
                                size="small"
                                class="p-button-primary"
                                (click)="
                                    btnItem(
                                        'searh_perfil_all',
                                        'Desea cargar todos los accesos'
                                    )
                                "
                            ></button>
                        </div>
                    </div>
                </form>
                <div class="card">
                    <app-table-primeng
                        [columnas]="columns"
                        [showCaption]="true"
                        [data]="lista_accesos"
                        (accionBtnItem)="accionBtnItemTable($event)"
                        [showPaginator]="true"
                        [subactions]=""
                        [(selectedRowData)]="selectedItems"
                        [actions]="actionsUsuario"
                        [ariaDisabled]="true"
                    >
                        <!-- <ng-container slot="caption-content"> </ng-container> -->
                    </app-table-primeng>
                </div>
            </app-container-page>
        </ng-template>
    </div>
    <div class="col-12 md:col-4">
        <div
            *ngIf="
                usuario?.cPersDocumento || usuario?.nombre_completo;
                else noData
            "
        >
            <app-container-page
                title="Perfil de usuario"
                [actions]="accionesPerfil"
                (accionBtnItem)="accionBtnItemTable($event)"
            >
                <p-panel header="InformaciÃ³n del Usuario" class="p-mb-3">
                    <div class="p-d-flex p-ai-center">
                        <p-tag severity="info" class="p-mr-2">
                            <span>{{
                                usuario?.cPersDocumento || 'Sin Documento'
                            }}</span>
                        </p-tag>
                        <p-tag severity="success">
                            <span>{{
                                usuario?.nombre_completo || 'Sin Nombre'
                            }}</span>
                        </p-tag>
                    </div>
                </p-panel>

                <form [formGroup]="form_perfil">
                    <div class="field col-12 md:col-12">
                        <span class="p-float-label">
                            <p-dropdown
                                [style]="{ width: '100%' }"
                                [options]="search_perfiles"
                                [filter]="false"
                                filterBy="cPerfilNombre"
                                optionLabel="cPerfilNombre"
                                optionValue="iPerfilId"
                                formControlName="iPerfilId"
                                (onChange)="
                                    btnItem('perfil', 'Desea asignar perfil')
                                "
                            />
                            <label for="iGrado">Perfil</label>
                        </span>
                    </div>
                </form>
                @if (form_usuario.invalid) {
                    <div class="card">
                        <app-table-primeng
                            [columnas]="columa_perfil"
                            [showCaption]="false"
                            [data]="perfil_usuario"
                            (accionBtnItem)="accionBtnItemTable($event)"
                            [showPaginator]="false"
                            [(selectedRowData)]="selectedItemsPerfil"
                            [actions]="actionsPerfil"
                        >
                            <!-- <ng-container slot="caption-content"> </ng-container> -->
                        </app-table-primeng>
                    </div>
                }
            </app-container-page>
        </div>
        <ng-template #noData>
            <p-message
                severity="warn"
                text="No hay datos del usuario"
            ></p-message>
        </ng-template>
    </div>
</div>
<p-toast />
