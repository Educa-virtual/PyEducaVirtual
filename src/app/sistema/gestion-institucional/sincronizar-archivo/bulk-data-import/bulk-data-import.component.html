<p-toast />

<div class="flex flex-column gap-4">
    <section>
        <h1>Importaci贸n masiva</h1>

        <div
            class="flex flex-wrap justify-content-between align-items-center"
            style="column-gap: 5rem; row-gap: 2rem"
        >
            <div class="flex flex-column gap-3 w-2">
                <span>Tipo de colecci贸n:</span>
                <form [formGroup]="typeCollectionForm">
                    <p-dropdown
                        styleClass="w-full"
                        formControlName="typeCollection"
                        [options]="typeCollections"
                        optionLabel="label"
                        placeholder="Seleccione una colecci贸n"
                    />
                </form>
            </div>

            <div class="flex flex-column gap-3">
                <span>Estructura de importaci贸n:</span>
                <p-button
                    icon="pi pi-download"
                    label="Descargar plantilla"
                    (onClick)="
                        downloadCollectionTemplate(
                            typeCollectionForm.value.typeCollection
                        )
                    "
                />
            </div>

            <div class="flex flex-column gap-3">
                <span>Archivo de origen:</span>
                <app-btn-file-upload
                    accept=".xlsx"
                    (fileChange)="loadCollectionTemplate($event)"
                />
            </div>

            <div class="flex flex-column gap-3">
                <span>Iniciar proceso:</span>
                <p-button
                    label="Verificar"
                    icon="pi pi-file-import"
                    [loading]="importLoad"
                    (onClick)="validaImportData()"
                />
            </div>
        </div>
    </section>

    <app-tab-view>
        <app-tab-panel title="Por procesar">
            <div class="card">
                @if (unverified_data) {
                    <app-table-primeng
                        [columnas]="columns"
                        [data]="unverified_data"
                        [showCaption]="true"
                        [showSortIcon]="false"
                    ></app-table-primeng>
                } @else {
                    <span class="block text-center"
                        >Sin datos que procesar</span
                    >
                }
            </div>
        </app-tab-panel>
        <app-tab-panel title="Registrados">
            <div class="card">
                @if (verified_data_recorded) {
                    <app-table-primeng
                        [columnas]="columns"
                        [data]="verified_data_recorded"
                        [showCaption]="false"
                        [showSortIcon]="false"
                    ></app-table-primeng>
                } @else {
                    <span class="block text-center"
                        >Sin datos que procesar</span
                    >
                }
            </div>
        </app-tab-panel>
        <app-tab-panel title="No registrados">
            <div class="card">
                @if (verified_data_not_recorded) {
                    <app-table-primeng
                        [columnas]="verified_columns_not_recorded"
                        [actions]="verified_actions_not_recorded"
                        [data]="verified_data_not_recorded"
                        [showCaption]="false"
                        [showSortIcon]="false"
                    ></app-table-primeng>
                } @else {
                    <span class="block text-center"
                        >Sin datos que procesar</span
                    >
                }
            </div>
        </app-tab-panel>
        <app-tab-panel title="Revisar errores">
            <div class="card">
                @if (data_verified_with_errors) {
                    <app-table-primeng
                        [columnas]="columns"
                        [data]="data_verified_with_errors"
                        [showCaption]="false"
                        [showSortIcon]="false"
                    ></app-table-primeng>
                } @else {
                    <span class="block text-center"
                        >Sin datos que procesar</span
                    >
                }
            </div>
        </app-tab-panel>
    </app-tab-view>
</div>
